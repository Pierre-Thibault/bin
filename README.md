# Personal Utility Scripts

> This README was generated by AI (Claude Code) based on the scripts in this directory.

A collection of bash scripts for various tasks including AI-assisted development, backup, and system utilities.

## AI-Powered Development Tools

### ai-groq
Fast AI assistant using the Groq API with Llama 3.3 70B model.

**Usage:**
```bash
ai-groq "your question"
echo "code" | ai-groq "explain this"
```

**Features:**
- Interactive Q&A mode or pipe code via stdin
- Fast inference using Groq's API
- Automatic code formatting in queries

**Setup:** Create `~/secrets/groq` containing your API key from https://console.groq.com/keys

---

### ai-groq-explain
Explains code while preserving the original. Perfect for editor integration.

**Usage:**
```bash
# In Helix editor: select code, then | ai-groq-explain "your question"
cat script.sh | ai-groq-explain "what does this do?"
```

**Features:**
- Returns original code followed by formatted explanation as comments
- Wraps explanations to 80 characters for readability
- Designed for text editor pipelines

**Setup:** Requires `~/secrets/groq` with your API key

---

### ai-ollama
Local AI helper using Ollama with Qwen 2.5 Coder model.

**Usage:**
```bash
ai-ollama "your question"
echo "code" | ai-ollama "explain this"
```

**Features:**
- Runs entirely locally (no API key needed)
- Strips ANSI color codes from output
- Cleaner output for editor integration

**Setup:** Requires [Ollama](https://ollama.ai/) installed with the `qwen2.5-coder:7b` model

---

### extract-var
AI-powered variable extraction refactoring tool for any programming language.

**Usage:**
```bash
# In Helix: select expression, then:
| extract-var                    # Auto-generate variable name
| extract-var myVariableName     # Use specific name
```

**Features:**
- Automatically detects programming language
- Generates variable declaration and replacement
- Preserves indentation

**Setup:** Requires `~/secrets/groq` with your API key

---

### wrap
AI-powered code wrapper that adds control structures around selected code.

**Usage:**
```bash
# In Helix: select code, then:
| wrap if           # Wrap in if statement
| wrap for          # Wrap in for loop
| wrap try-catch    # Wrap in try-catch block
| wrap function     # Wrap in function
```

**Features:**
- Auto-detects programming language
- Preserves indentation and code style
- Works with any wrapper type

**Setup:** Requires `~/secrets/groq` with your API key

---

### unwrap
AI-powered code unwrapper that removes outer control structures.

**Usage:**
```bash
# In Helix: select wrapped code, then:
| unwrap
```

**Features:**
- Removes outermost wrapper (if, for, while, function, try-catch, etc.)
- Automatically adjusts indentation
- Preserves inner code structure

**Setup:** Requires `~/secrets/groq` with your API key

---

## System Utilities

### backup
Encrypted compressed backup script using tar and GPG.

**Usage:**
```bash
./backup
# Enter passphrase when prompted
```

**Features:**
- Backs up home directory folders individually
- Excludes folders containing `.nobackup` file
- Creates separate archive for dot files
- Strong GPG encryption with passphrase

**Configuration:**
Edit these variables in the script:
- `source`: Directory to backup (default: `$HOME`)
- `destination`: Where to save archives

**Restoration:**
```bash
gpg -d folder.tar.gz.pgp | tar -xvzf -
```

**Dependencies:** tar, gpg

---

### detache
Runs commands in a detached process that survives terminal closure.

**Usage:**
```bash
detache command [args...]
# Example: detache firefox
```

**Features:**
- Process continues after terminal closes
- Redirects output to /dev/null
- Clean detachment using setsid

---

### download_audio
Downloads audio from online videos (YouTube, etc.) in highest quality.

**Usage:**
```bash
download_audio "https://youtube.com/watch?v=..."
```

**Features:**
- Downloads best available audio
- Converts to ALAC format
- 8 parallel connections for faster downloads

**Dependencies:** [yt-dlp](https://github.com/yt-dlp/yt-dlp/)

**Note:** Can be run with Nix using the shebang directive

---

### update-dynamic-ip
Monitors and updates dynamic DNS records when your public IP changes.

**Usage:**
```bash
# Run manually:
./update-dynamic-ip

# Or add to crontab for startup:
# @reboot /path/to/update-dynamic-ip
```

**Configuration:**
Edit these variables in the script:
- `DOMAIN`: Your domain name
- `PASSWORD`: Dynamic DNS password from your registrar
- `INTERVAL`: Check interval in minutes

**Features:**
- Continuous monitoring of public IP
- Automatic DNS updates via Namecheap API
- Configurable check interval

**Dependencies:** dig, curl (managed by Nix)

---

## Installation

1. Clone or copy these scripts to `~/bin/` (or any directory in your PATH)
2. Make scripts executable: `chmod +x ~/bin/*`
3. For Groq-powered scripts, create `~/secrets/groq` with your API key
4. For Ollama script, install Ollama and pull the model: `ollama pull qwen2.5-coder:7b`
5. For download_audio, install yt-dlp or use the Nix shebang

## Editor Integration

Most AI scripts are designed for use with text editors like Helix:

1. Select text in editor
2. Pipe through script: `| script-name [args]`
3. Selected text is replaced with script output

Example workflow in Helix:
- Select code block
- Type `:` to enter command mode
- Type `| wrap if` to wrap in if statement
- Or `| extract-var result` to extract into variable

### Helix Configuration

To set up convenient keybindings for the AI refactoring tools, add this to your `~/.config/helix/config.toml`:

```toml
[keys.normal.space.r]  # space + r = refactoring menu
i = ":pipe wrap if"
f = ":pipe wrap for"
t = ":pipe wrap try-catch"
u = ":pipe unwrap"
e = ":pipe extract"
```

This creates a refactoring menu under `Space + r`:
- `Space + r + i`: Wrap selection in if statement
- `Space + r + f`: Wrap selection in for loop
- `Space + r + t`: Wrap selection in try-catch block
- `Space + r + u`: Unwrap selection (remove outer wrapper)
- `Space + r + e`: Extract selection into a variable

## License

Scripts created by Pierre Thibault are MIT licensed.
